# .codex/PR-26.md â€” Encryption at Rest (Segment Encryption Hooks)

## Goal
Add encryption-at-rest support for log segments with key rotation hooks.

## Deliverables
- Config:
  - enable encryption
  - key id reference (not the key itself)
- Encryption scheme:
  - per-segment key derived from master key id (hook)
  - authenticated encryption (e.g., AES-GCM or ChaCha20-Poly1305)
- Key material retrieval via a `KeyProvider` trait (env/dummy for tests).
- Rotation:
  - new segments use new key id
  - old segments remain readable

## Tests
- Encrypted segment read/write roundtrip.
- Wrong key fails to decrypt.

## Acceptance
- No plaintext atoms on disk when encryption enabled.
