# .codex/PR-41.md — component-dwbase: Structured Tool Errors + Warning Semantics

## Goal
Make `component-dwbase` safe and operable in flows by replacing “empty-string/empty-result” failure signals with structured, inspectable errors and warnings.

## Deliverables
- Introduce a stable error shape for tool operations (no stack traces):
  - `code` (string enum), `message` (string), `details` (object, optional)
- Update the WIT surface and component implementation so that:
  - `remember` returns either `atom-id` or a structured error
  - `ask` returns `Answer` with `warnings` when degraded/fallback occurs, and structured error for denied/invalid inputs
  - `observe_*` and `health` return structured errors on invalid handles/inputs
- Align `component.manifest.json` schemas with the new output shapes.
- Document error codes in `docs/component-dwbase.md`.

## Constraints
- Prefer additive, backwards-compatible changes where possible (e.g., add new ops like `remember_v2` if needed).
- Do not print secrets (NATS creds, key material).

## Tests
- Capability denied produces deterministic `code`.
- Oversize payload produces deterministic `code`.
- Invalid observe handle produces deterministic `code`.

## Acceptance
- Hosts/flows can reliably branch on `code` without parsing strings.
- No operation uses “empty string means error” for v2 surfaces.

