# .codex/PR-25.md â€” Index Lifecycle: Versioning + Atomic Swap + Staleness Fallback

## Goal
Make indexes production-safe: versioned rebuilds, atomic switch-over, and safe query fallback when index is stale/missing.

## Deliverables
- Index metadata:
  - index version
  - embedder model version
  - last rebuilt timestamp
- Build new index in background, then atomic swap.
- ask() fallback:
  - if ANN not ready, use reflex + storage scan (bounded) and return with warning metadata
- Add `dwbase index status` command.

## Tests
- Simulate embedder version change triggers rebuild.
- Atomic swap does not break concurrent queries.

## Acceptance
- Queries remain correct during rebuild.
