# .codex/PR-09.md â€” Security: Capabilities + Trust + Gatekeeper (dwbase-security)

## Goal
Implement capability enforcement and basic trust scoring.

## Deliverables
In `crates/dwbase-security`:
- `Capabilities` model:
  - read_worlds, write_worlds
  - labels_write, kinds_write
  - importance_cap
  - rate_limits (remember/sec, ask/min)
  - offline_policy placeholder
- `TrustStore`:
  - per-worker trust score
  - per-node trust score (optional)
- `Gatekeeper` implementation:
  - checks remember/ask/manage_world against caps
  - enforces max importance
  - simple rate limiting (token bucket)

## Tests
- capability denied cases
- rate limiting works deterministically in tests (inject clock)