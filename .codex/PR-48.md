# .codex/PR-48.md â€” Index Rebuild: Background Execution + Progress + Readiness/Warn Signals

## Goal
Make index lifecycle production-safe: background rebuild, progress reporting, and consistent warnings/readiness behavior.

## Deliverables
- Background index rebuild with atomic swap (per-world):
  - build new index, then swap pointers
- Track rebuild progress:
  - start time, last progress timestamp, percent/steps (best-effort)
  - expose via `dwbase index status`
- Health integration:
  - `dwbase.health` reports `degraded` when rebuild lag exceeds threshold
  - `ask` returns warnings when falling back due to stale/missing index

## Tests
- Concurrent queries remain correct during rebuild (no panics, stable results).
- Embedder version change triggers rebuild deterministically.

## Acceptance
- Operators can see rebuild state and queries remain correct during rebuilds.

