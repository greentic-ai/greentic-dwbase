# .codex/PR-23.md â€” Durable Log Hardening (Checksums + Recovery)

## Goal
Harden canonical append-only log segments for crash consistency and corruption detection.

## Deliverables
- Add segment framing:
  - length prefix
  - checksum (e.g., CRC32C or Blake3 hash)
- On startup:
  - detect truncated/corrupt tail
  - safely truncate to last good frame
  - emit a signal atom (or log) about recovery event
- Add `dwbase storage check` (CLI) to validate segments.

## Tests
- Simulate partial write; ensure recovery truncates safely.
- Corruption detection test.

## Acceptance
- Node starts reliably after simulated crash and preserves all valid atoms.
